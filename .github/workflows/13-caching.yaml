name: 13-caching
on: 
    push:
        branches: 
            - main
    workflow_dispatch:
        inputs:
            use-cache:
                type: boolean
                description: "use cache"
                default: true
defaults:
   run: 
         working-directory: react-app

jobs:
    checkout:
        runs-on: ubuntu-latest
        steps:
            - name: Checkout
              uses: actions/checkout@v4

            - name : setup the node
              uses: actions/setup-node@v3
              with:
                    node-version: '22.x'
            - name: download cached dependancies
              id: cache
              uses: actions/cache@v3
              with:
                    path:  ~/.npm
                    key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}
                   

            - name : install dependencies
              if: steps.cache.outputs.cache-hit != 'true'
              run: npm ci

            - name : build the application
              run: npm run build 

            - name: run unit tests
              run: npm run test
                
    
            
    
       